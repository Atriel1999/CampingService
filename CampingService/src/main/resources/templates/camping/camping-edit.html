<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>캠핑가자</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  
   <!-- jQuery-->
   <script th:src="@{/vendor/jquery/jquery.min.js}"></script>
   <!-- Bootstrap JS bundle - Bootstrap + PopperJS-->
   <script th:src="@{/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>
   <!-- Magnific Popup - Lightbox for the gallery-->
   <script th:src="@{/vendor/magnific-popup/jquery.magnific-popup.min.js}"></script>
   <!-- Smooth scroll-->
   <script th:src="@{/vendor/smooth-scroll/smooth-scroll.polyfills.min.js}"></script>
   <!-- Bootstrap Select-->
   <script th:src="@{/vendor/bootstrap-select/js/bootstrap-select.min.js}"></script>
   <!-- Object Fit Images - Fallback for browsers that don't support object-fit-->
   <script th:src="@{/vendor/object-fit-images/ofi.min.js}"></script>
   <!-- Swiper Carousel                       -->
   <script th:src="@{https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.4.1/js/swiper.min.js}"></script>
   <script>var basePath = ''</script>
   <!-- Main Theme JS file    -->
   <script th:src="@{/js/theme.js}"></script>
  <!-- Dropzone.js-->
   <script th:src="@{/vendor/dropzone/dropzone.js}"></script>
   <!-- Dropzone Init-->
  <!-- Map-->
  <script th:src="@{https://unpkg.com/leaflet@1.5.1/dist/leaflet.js}"
    integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
    crossorigin=""></script>
  <!-- Available tile layers-->
  
  <!-- Price Slider Stylesheets -->
    <link rel="stylesheet" th:href="@{/vendor/nouislider/nouislider.css}">
    <!-- Google fonts - Playfair Display-->
    <link rel="stylesheet" th:href="@{https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700}">
    <!-- Google fonts - Poppins-->
    <link rel="stylesheet" th:href="@{https://fonts.googleapis.com/css?family=Poppins:300,400,400i,700}">
    <!-- swiper-->
    <link rel="stylesheet" th:href="@{https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.4.1/css/swiper.min.css}">
    <!-- Magnigic Popup-->
    <link rel="stylesheet" th:href="@{/vendor/magnific-popup/magnific-popup.css}">
  <!-- Leaflet Maps-->
  <link rel="stylesheet" th:href="@{https://unpkg.com/leaflet@1.5.1/dist/leaflet.css}"
    integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    crossorigin="">
  <!-- theme stylesheet-->
    <link rel="stylesheet" th:href="@{/css/style.default.css}" id="theme-stylesheet">
    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" th:href="@{/css/custom.css}">
    <!-- Favicon-->
    <link rel="shortcut icon" th:href="@{/img/favicon.png}">
    <link rel="stylesheet" media="screen" th:href="@{/css/theme.min.css}">
  <!-- Tweaks for older IEs--><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
  <!-- Font Awesome CSS-->
  <link rel="stylesheet" th:href="@{https://use.fontawesome.com/releases/v5.8.1/css/all.css}"
    integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

  <style>
    .page-loading {
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 100%;
      -webkit-transition: all .4s .2s ease-in-out;
      transition: all .4s .2s ease-in-out;
      background-color: #1f1b2d;
      opacity: 0;
      visibility: hidden;
      z-index: 9999;
    }

    .page-loading.active {
      opacity: 1;
      visibility: visible;
    }

    .page-loading-inner {
      position: absolute;
      top: 50%;
      left: 0;
      width: 100%;
      text-align: center;
      -webkit-transform: translateY(-50%);
      transform: translateY(-50%);
      -webkit-transition: opacity .2s ease-in-out;
      transition: opacity .2s ease-in-out;
      opacity: 0;
    }

    .page-loading.active>.page-loading-inner {
      opacity: 1;
    }

    .page-loading-inner>span {
      display: block;
      font-size: 1rem;
      font-weight: normal;
      color: #fff;
      ;
    }

    .page-spinner {
      display: inline-block;
      width: 2.75rem;
      height: 2.75rem;
      margin-bottom: .75rem;
      vertical-align: text-bottom;
      border: .15em solid #9691a4;
      border-right-color: transparent;
      border-radius: 50%;
      -webkit-animation: spinner .75s linear infinite;
      animation: spinner .75s linear infinite;
    }

    @-webkit-keyframes spinner {
      100% {
        -webkit-transform: rotate(360deg);
        transform: rotate(360deg);
      }
    }

    @keyframes spinner {
      100% {
        -webkit-transform: rotate(360deg);
        transform: rotate(360deg);
      }
    }
  </style>
</head>

<body style="padding-top: 72px;">
  <!-- 헤더 시작 -->
    <th:block th:replace="common/header :: headerFragment"></th:block>
  <!-- 헤더 끝 -->
  <!-- dropzone 임시 <input name="file" type="file" style="display:none" multiple/> -->
  
  <div class="container-fluid">
  <form th:action="@{/camping/camping-edit}" method="POST" enctype="multipart/form-data">
    <div class="row">
      <div class="col-lg-7 col-xl-5 px-4 pb-4 ps-xl-5 pe-xl-5">
        <section class="mx-n4 mx-xl-n5 mb-4 mb-xl-5">
          <!-- Slider main container-->
          <div class="swiper-container booking-detail-slider">
            <section class="py-5">
              <div class="container">
                <h1 class="h2 mb-5"> 캠핑 사진</h1>
                <p class="subtitle text-primary mb-2">대표 이미지를 보여주세요</p>
                  <div class="col-lg-12 ms-auto" runat="server">       
                  	  <!-- 파일 업로드 -->
                      <div class="dropzone" id="demo-upload" action="#">
                        <div class="dz-message text-muted">
                        	<p>파일을 드래그하거나 여기를 클릭해서 업로드하세요</p>
                        </div>
                      </div>
                    <div class="d-none" id="dropzoneTemplate">
                      <div class="dz-preview dz-file-preview">
                        <div class="dz-image"><img data-dz-thumbnail="" alt="" th:src="@{/img/logo-square.svg}"></div>
                        <div class="dz-details">
                          <div class="dz-filename"><span data-dz-name=""></span></div>
                          <div class="dz-size" data-dz-size=""></div>
                        </div>
                        <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress=""></span></div>
                        <div class="dz-success-mark"><span class="dz-icon"><i class="fa-check fa"></i></span></div>
                        <div class="dz-error-mark"><span class="dz-icon"><i class="fa-times fa"></i></span></div>
                        <div class="dz-error-message"><span data-dz-errormessage=""></span></div>
                      </div>
                    </div>
                  </div>
              </div>
            </section>

            
            <div class="swiper-pagination swiper-pagination-white"></div>
            <div class="swiper-button-prev swiper-button-white"></div>
            <div class="swiper-button-next swiper-button-white"> </div>
          </div>
        </section>
        
        
        <div class="text-block">
          <label class="form-label" for="form_search">캠핑이름</label>
          <div class="input-label-absolute input-label-absolute-right mb-4">
          	<input type="hidden" name="cid" id="cid" th:value="${camp.cid}">
          	<input type="hidden" name="siteid" id="siteid" th:value="${site.siteid}">
            <input class="form-control pe-4" type="search" name="cname" placeholder="이름을 적어주세요" id="cname" th:value="${camp.cname}">
          </div>
          
          <div class="mb-4">
            <label class="form-label" for="form_neighbourhood">캠핑종류</label>
            <select class="selectpicker form-control" name="ctype" id="ctype" th:value="${camp.ctype}" data-style="btn-selectpicker" data-live-search="true" data-selected-text-format="count &gt; 1" data-none-selected-text="">
              <option value="1" th:selected="${camp.ctype} == '1'">오토캠핑</option>
              <option value="2" th:selected="${camp.ctype} == '2'">백패킹</option>
              <option value="3" th:selected="${camp.ctype} == '3'">차박캠핑</option>
              <option value="4" th:selected="${camp.ctype} == '4'">미니멀캠핑</option>
              <option value="5" th:selected="${camp.ctype} == '5'">글램핑</option>
            </select>
          </div>
          
          <div class="row pt-4">
            <div class="mb-4 col-md-12">
              <label class="form-label" for="name">캠핑 시작일(년-월-일)</label>
              <input class="form-control" type="date" name="cstart" id="cstart" th:field="${camp.cstart}">
            </div>

            <div class="mb-4 col-md-12">
              <label class="form-label" for="name">캠핑 종료년도(년-월-일)</label>
              <input class="form-control" type="date" name="cend" id="cend" th:field="${camp.cend}">
            </div>

          </div>
        </div>

        <div class="row pt-4">
          <div class="mb-4 col-md-6">
            <label class="form-label" for="name">주소지</label>
            <input class="form-control" type="text" th:value="${site.sitecompany}">
          </div>
          <div class="mb-4 col-md-6">
            <label class="form-label" for="name">전화번호</label>
            <input class="form-control" type="text" name="cphone" id="cphone" th:value="${camp.cphone}">
          </div>
        </div>

        <div class="text-block">
          <div class="d-flex align-items-center justify-content-between mb-3">
            <div>
              <h6>참여자 목록</h6>
              <p class="text-muted mb-0"><a href="user-profile.html" class="text-black" th:text="${organizer.username}"></a>님에 의해 주최되었어요 </p>
            </div><a href="user-profile.html"><img class="avatar avatar-lg p-1 flex-shrink-0 ms-4"
                th:src="@{${organizer.userimage}}" alt="IMG null"></a>
          </div>
        </div>
        <div class="text-block">
          <h6 class="mb-3">참여자</h6>
          <th:block th:if="${participant == null || #lists.size(participant) == 0}">
				<tr>
					<td colspan="6">참여자가 아직 없습니다.</td>
				</tr>
		  </th:block>
		  <th:block th:if="${participant != null && #lists.size(participant) != 0}">
	          <div class="row mb-3">
		            <div class="col-auto text-center text-sm" th:each="listdata : ${participant}">
		            	<img class="avatar avatar-border-white mb-1" th:src="@{${'/img/avatar/'+listdata.userimage}}" alt="프로필오류"><br th:text="${listdata.username}">
		            </div>
	          </div>
          </th:block>
          
        <div class="text-block">
          <div class="row">
            <div class="col">
              <h6> 총 예상 지출금액</h6>
              <div class="input-label-absolute input-label-absolute-right mb-4">
                <input class="form-control pe-4" type="search" name="cexpense" placeholder="₩" th:value="${camp.cexpense}" id="cexpense">
              </div>
            </div>
          </div>
        </div>
        <div class="mb-4">
          <label class="form-label">태그</label>
          <ul class="list-unstyled mb-0">
            <li th:object="${camp}">
            <!-- https://www.thymeleaf.org/doc/tutorials/3.0/thymeleafspring.html#checkbox-fields -->
              <div class="form-check">
                <input class="form-check-input" type="checkbox" th:field="*{cchild}" value="1">
                <label class="form-check-label" for="cchild1">미성년자 참여 가능</label>
              </div>
            </li>
            <li th:object="${camp}">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" th:field="*{cdrink}" value="1">
                <label class="form-check-label" for="cdrink1">음주 가능</label>
              </div>
            </li>
            <li th:object="${camp}">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" th:field="*{csmoking}" value="1">
                <label class="form-check-label" for="csmoking1">흡연 가능</label>
              </div>
            </li>
            <li th:object="${camp}">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" th:field="*{cpet}" value="1">
                <label class="form-check-label" for="cpet1">애완동물 가능</label>
              </div>
            </li>
          </ul>
        </div>

        <div class="text-block">
            <div>
              <h6>세부설명</h6>
                <div class="input-group">
                  <textarea class="form-control border-0 p-4 bg-light text-sm" placeholder="세부설명을 적으세요" aria-describedby="button-sendMessage" name="cdetail" th:text="${camp.cdetail}"></textarea>
                </div>
            </div>
        </div>

        <div class="text-block d-print-none">
          <button id="btn-upload" class="btn btn-link ps-0" type="submit"><i class="fa fa-pen-fancy me-2"></i>수정완료 </button>
        </div>
        </form>
      </div>
      
      <!-- 지도 -->
      <div class="col-lg-5 col-xl-7 map-side-lg px-lg-0">
        <div class="map-full shadow-left" id="map"></div>
      </div>
      
    </div>
  </div>
  
  <!-- 푸터-->
    <th:block th:replace="~{common/footer :: footerFragment}"></th:block>
  <!--푸터-->
  <!-- JavaScript files-->
  	<script>
      Dropzone.autoDiscover = false;
      $("#demo-upload").dropzone({
        url: '/camping/camping-edit', // 파일 업로드할 url
		method: "post",
		autoProcessQueue: false,
		parallelUploads: 5,
        paramName: 'file',
		params: {'param_1':[[${camp.cid}]]},
		clickable: true,
		acceptedFiles: '.jpeg,.jpg,.png,.gif,.JPEG,.JPG,.PNG,.GIF',
		addRemoveLinks: true, // 업로드 후 파일 삭제버튼 표시 여부
		dictRemoveFile: '삭제', // 삭제버튼 표시 텍스트
		uploadMultiple: true,
		init: function () {
		    var submitButton = document.querySelector("#btn-upload");
		    var myDropzone = this;
		    submitButton.addEventListener("click", function () {
		        console.log("업로드");
		        
		        if (myDropzone.getRejectedFiles().length > 0) {
		            let files = myDropzone.getRejectedFiles();
		            console.log('거부된 파일이 있습니다.', files);
		            return;
		         }
		        
		        myDropzone.processQueue();
		    });

		      // 서버로 파일이 성공적으로 전송되면 실행
		      this.on('success', function (file, responseText) {
		    	  console.log('성공');
		      });
			},
		});
	</script>


  
  <!-- JavaScript files-->
  <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=d4f714a0c0bfde03c6f3babdfc6fa465"></script>
  <script>
	var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
	    mapOption = { 
	        center: new kakao.maps.LatLng([[${site.sitey}]], [[${site.sitex}]]), // 지도의 중심좌표
	        level: 4 // 지도의 확대 레벨
	    };
	
	var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다
	 
	// 버튼을 클릭하면 아래 배열의 좌표들이 모두 보이게 지도 범위를 재설정합니다 
	var points = [
	    new kakao.maps.LatLng([[${site.sitey}]], [[${site.sitex}]])
	];
	
	// 지도를 재설정할 범위정보를 가지고 있을 LatLngBounds 객체를 생성합니다
	var bounds = new kakao.maps.LatLngBounds();    
	
	var i, marker;
	for (i = 0; i < points.length; i++) {
	    // 배열의 좌표들이 잘 보이게 마커를 지도에 추가합니다
	    marker =     new kakao.maps.Marker({ position : points[i] });
	    marker.setMap(map);
	    
	    // LatLngBounds 객체에 좌표를 추가합니다
	    bounds.extend(points[i]);
	}
	
	function setBounds() {
	    // LatLngBounds 객체에 추가된 좌표들을 기준으로 지도의 범위를 재설정합니다
	    // 이때 지도의 중심좌표와 레벨이 변경될 수 있습니다
	    map.setBounds(bounds);
	}
	
	// 커스텀 오버레이에 표시할 컨텐츠 입니다
	// 커스텀 오버레이는 아래와 같이 사용자가 자유롭게 컨텐츠를 구성하고 이벤트를 제어할 수 있기 때문에
	// 별도의 이벤트 메소드를 제공하지 않습니다 
	var content = '<div class="wrap">' + 
	            '    <div class="info">' + 
	            '        <div class="title">' + 
	            '            [[${site.sitecompany}]]' + 
	            '            <div class="close" onclick="closeOverlay()" title="닫기"></div>' + 
	            '        </div>' + 
	            '        <div class="body">' + 
	            '            <div class="img">' +
	            '                <img src="[[${site.siteimage}]]" width="73" height="70">' +
	            '           </div>' + 
	            '            <div class="desc">' + 
	            '                <div class="ellipsis">[[${site.siteaddr}]]</div>' + 
	            '                <div class="jibun ellipsis">[[${site.siteinduty}]]</div>' + 
	            '                <div><a href="[[${site.siteurl}]]" target="_blank" class="link">홈페이지</a></div>' + 
	            '            </div>' + 
	            '        </div>' + 
	            '    </div>' +    
	            '</div>';

	// 마커 위에 커스텀오버레이를 표시합니다
	// 마커를 중심으로 커스텀 오버레이를 표시하기위해 CSS를 이용해 위치를 설정했습니다
	var overlay = new kakao.maps.CustomOverlay({
	    content: content,
	    map: map,
	    position: marker.getPosition()       
	});

	// 마커를 클릭했을 때 커스텀 오버레이를 표시합니다
	kakao.maps.event.addListener(marker, 'click', function() {
	    overlay.setMap(map);
	});

	// 커스텀 오버레이를 닫기 위해 호출되는 함수입니다 
	function closeOverlay() {
	    overlay.setMap(null);     
	}
	</script>
  
  <script>
    // ------------------------------------------------------- //
    //   Inject SVG Sprite - 
    //   see more here 
    //   https://css-tricks.com/ajaxing-svg-sprite/
    // ------------------------------------------------------ //
    function injectSvgSprite(path) {

      var ajax = new XMLHttpRequest();
      ajax.open("GET", path, true);
      ajax.send();
      ajax.onload = function (e) {
        var div = document.createElement("div");
        div.className = 'd-none';
        div.innerHTML = ajax.responseText;
        document.body.insertBefore(div, document.body.childNodes[0]);
      }
    }
    // to avoid CORS issues when viewing using file:// protocol, using the demo URL for the SVG sprite
    // use your own URL in production, please :)
    // https://demo.bootstrapious.com/directory/1-0/icons/orion-svg-sprite.svg
    //- injectSvgSprite('${path}icons/orion-svg-sprite.svg'); 
    injectSvgSprite('https://demo.bootstrapious.com/directory/1-4/icons/orion-svg-sprite.svg');

  </script>


</body>

</html>